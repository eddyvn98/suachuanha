"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423,21],{5428:function(t,e,n){n.d(e,{Z:function(){return p}});var r=n(3827),o=n(4090),i=n(2235),a=n(7366),c=n(3416),s=n(2805);function l(t,e){if(!e)return"T\xf4i cần hỗ trợ về vấn đề nh\xe0 cửa.";let n="\uD83C\uDD98 CẦN HỖ TRỢ: ".concat(e.label||"Vấn đề nh\xe0 cửa","\n\n");n+="\uD83D\uDCCB Vấn đề:\n"+"".concat(e.description||e.label||"Vấn đề cần được hỗ trợ","\n\n")+"\uD83D\uDEE0️ Đ\xe3 thử c\xe1c c\xe1ch sau:\n",t&&t.attempts&&t.attempts.length>0?t.attempts.forEach((t,r)=>{var o;let i=null===(o=e.trials)||void 0===o?void 0:o.find(e=>e.id===t.trialId),a=i?i.title:t.trialId,c="success"===t.result?"✅ Đ\xe3 được":"❌ Chưa được";n+="".concat(r+1,". ").concat(a," - ").concat(c,"\n"),i&&i.when&&(n+="   (".concat(i.when,")\n"))}):e.trials&&e.trials.length>0?n+="- Chưa thử giải ph\xe1p n\xe0o.\n"+"- C\xf3 ".concat(e.trials.length," c\xe1ch tự xử l\xfd được đề xuất.\n"):n+="- Chưa thử giải ph\xe1p n\xe0o.\n",n+="\n\uD83D\uDC49 Nhờ cộng đồng hoặc thợ tư vấn gi\xfap em với ạ!\n";let r=window.location.origin;return e.id?n+="\uD83D\uDD17 Xem chi tiết v\xe0 tự sửa tại: ".concat(r,"/issue/").concat(e.id,"/solutions"):n+="\uD83D\uDD17 Xem chi tiết tại: ".concat(r),n}function u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=window.location.origin,o=btoa(unescape(encodeURIComponent(n||l(t,e))));return"".concat(r,"/feed?report=").concat(o,"&caseId=").concat(t.caseId,"&jobId=").concat(t.id)}var d=n(6021);function p(t){let{isOpen:e,onClose:n,job:p,caseData:h}=t,[f,g]=(0,o.useState)(""),[x,b]=(0,o.useState)("");if((0,o.useEffect)(()=>{if(e&&h){let t=l(p,h);if(g(t),p)b(u(p,h,t));else{let e=window.location.origin,n=btoa(unescape(encodeURIComponent(t)));b("".concat(e,"/feed?report=").concat(n,"&caseId=").concat(h.id))}}else e&&!h&&(g("T\xf4i cần hỗ trợ về vấn đề nh\xe0 cửa."),b(window.location.origin+"/feed"))},[e,p,h]),!e)return null;let m=async()=>{try{await navigator.clipboard.writeText(f),d.toast.success("Đ\xe3 sao ch\xe9p nội dung b\xe0i đăng!")}catch(t){d.toast.error("Kh\xf4ng thể sao ch\xe9p")}},v=async()=>{try{await navigator.clipboard.writeText(x);let t=encodeURIComponent(x);window.open("https://www.facebook.com/sharer/sharer.php?u=".concat(t),"_blank","width=600,height=400"),d.toast.success("Đ\xe3 sao ch\xe9p link! Đang mở Facebook để chia sẻ...")}catch(t){d.toast.error("Kh\xf4ng thể sao ch\xe9p link")}};return(0,r.jsx)("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true","aria-labelledby":"support-modal-title",onClick:n,onKeyDown:t=>{"Escape"===t.key&&n()},children:(0,r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",width:"100%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},onClick:t=>t.stopPropagation(),children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px",borderBottom:"1px solid #e4e6eb"},children:[(0,r.jsx)("h2",{id:"support-modal-title",style:{fontSize:"20px",fontWeight:"600",color:"#212529",margin:0},children:"B\xe1o c\xe1o hỗ trợ"}),(0,r.jsx)("button",{onClick:n,"aria-label":"Đ\xf3ng",style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)(i.Z,{size:24,color:"#65676b","aria-hidden":"true"})})]}),(0,r.jsxs)("div",{style:{padding:"20px"},children:[(0,r.jsx)("p",{style:{fontSize:"14px",color:"#65676b",marginBottom:"16px",lineHeight:"1.5"},children:"Mọi người sẽ thấy th\xf4ng tin n\xe0y để tư vấn cho bạn. Bạn c\xf3 thể đăng c\xf4ng khai hoặc chia sẻ ri\xeang."}),(0,r.jsx)("textarea",{value:f,onChange:t=>{let e=t.target.value;e.length<=5e3&&(g(e),b(u(p,h,e)))},placeholder:"T\xf4i cần hỗ trợ về vấn đề nh\xe0 cửa.",maxLength:5e3,style:{width:"100%",minHeight:"200px",padding:"var(--space-md)",fontSize:"var(--text-sm)",border:"2px solid var(--neutral-border)",borderRadius:"var(--radius-md)",outline:"none",resize:"vertical",fontFamily:"inherit",lineHeight:"var(--leading-relaxed)",marginBottom:"var(--space-md)"}}),(0,r.jsxs)("div",{style:{fontSize:"var(--text-xs)",color:"var(--text-tertiary)",textAlign:"right",marginTop:"-12px",marginBottom:"var(--space-md)"},children:[f.length," / 5000 k\xfd tự"]}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,r.jsxs)("button",{onClick:()=>{let t={id:Date.now(),caseId:p.caseId,jobId:p.id,label:h.label,content:f,timestamp:new Date().toISOString(),author:"T\xf4i (Bạn)"},e=JSON.parse(localStorage.getItem("userSupportPosts")||"[]");localStorage.setItem("userSupportPosts",JSON.stringify([t,...e])),d.toast.success("Đ\xe3 đăng l\xean Feed c\xf4ng khai!"),n()},style:{width:"100%",padding:"14px",fontSize:"16px",fontWeight:"600",backgroundColor:"#1877f2",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"background-color 0.2s"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="#166fe5",onMouseLeave:t=>t.currentTarget.style.backgroundColor="#1877f2",children:[(0,r.jsx)(a.Z,{size:20}),"Đăng l\xean Feed cộng đồng"]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,r.jsxs)("button",{onClick:m,style:{flex:1,padding:"12px",fontSize:"14px",fontWeight:"500",backgroundColor:"#f3f4f6",color:"#212529",border:"none",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,r.jsx)(c.Z,{size:18}),"Ch\xe9p lời nhờ"]}),(0,r.jsxs)("button",{onClick:v,style:{flex:1,padding:"12px",fontSize:"14px",fontWeight:"500",backgroundColor:"#f3f4f6",color:"#212529",border:"none",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,r.jsx)(s.Z,{size:18}),"Chia sẻ Link"]})]})]})]})]})})}},6021:function(t,e,n){n.r(e),n.d(e,{default:function(){return g},toast:function(){return f}});var r=n(3827),o=n(4090),i=n(6578),a=n(1483),c=n(1524),s=n(8814),l=n(2235);let u={success:i.Z,error:a.Z,warning:c.Z,info:s.Z};function d(t){let{id:e,message:n,type:i="info",duration:a=3e3,onClose:c}=t,d=u[i]||s.Z;return(0,o.useEffect)(()=>{if(a>0){let t=setTimeout(()=>{null==c||c(e)},a);return()=>clearTimeout(t)}},[a,e,c]),(0,r.jsxs)("div",{className:"toast toast-".concat(i),role:"alert","aria-live":"polite",children:[(0,r.jsx)(d,{size:20,color:"var(--color-".concat("error"===i?"error":"success"===i?"success":"warning"===i?"warning":"info",")")}),(0,r.jsx)("div",{style:{flex:1,fontSize:"14px",color:"var(--text-primary)"},children:n}),(0,r.jsx)("button",{onClick:()=>null==c?void 0:c(e),style:{background:"none",border:"none",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",color:"var(--text-secondary)"},"aria-label":"Đ\xf3ng th\xf4ng b\xe1o",children:(0,r.jsx)(l.Z,{size:16})})]})}let p=0,h=[],f={success:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,n="toast-".concat(++p);return h.forEach(r=>r({id:n,message:t,type:"success",duration:e})),n},error:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3,n="toast-".concat(++p);return h.forEach(r=>r({id:n,message:t,type:"error",duration:e})),n},warning:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,n="toast-".concat(++p);return h.forEach(r=>r({id:n,message:t,type:"warning",duration:e})),n},info:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,n="toast-".concat(++p);return h.forEach(r=>r({id:n,message:t,type:"info",duration:e})),n}};function g(){let[t,e]=(0,o.useState)([]),n=(0,o.useCallback)(t=>{e(e=>[...e,t])},[]),i=(0,o.useCallback)(t=>{e(e=>e.filter(e=>e.id!==t))},[]);return((0,o.useEffect)(()=>(h.push(n),()=>{h=h.filter(t=>t!==n)}),[n]),0===t.length)?null:(0,r.jsx)("div",{className:"toast-container","aria-live":"polite","aria-atomic":"true",children:t.map(t=>(0,r.jsx)(d,{id:t.id,message:t.message,type:t.type,duration:t.duration,onClose:i},t.id))})}},4908:function(t,e,n){n.d(e,{CC:function(){return g},Cq:function(){return o},EA:function(){return h},Jk:function(){return s},YQ:function(){return i},nv:function(){return c},rj:function(){return u},sQ:function(){return a},xI:function(){return x},zF:function(){return d},ze:function(){return p}});let r="repair_jobs";function o(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=i(t);if(r)return r;let o={id:"job-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),caseId:t,caseLabel:e.label,caseIcon:e.icon,status:"SELF_FIXING",currentStep:0,currentTrialId:n[0]||null,recommendedTrialIds:n,attempts:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},c=a();return c.push(o),f(c),o}function i(t){return a().find(e=>e.caseId===t&&("SELF_FIXING"===e.status||"NEED_PRO"===e.status||"ASSIGNED"===e.status||"IN_PROGRESS"===e.status))||null}function a(){try{let t=localStorage.getItem(r);return t?JSON.parse(t):[]}catch(t){return console.error("Error reading jobs from storage:",t),[]}}function c(){return a().find(t=>"SELF_FIXING"===t.status||"NEED_PRO"===t.status||"ASSIGNED"===t.status||"IN_PROGRESS"===t.status)||null}function s(t){return a().find(e=>e.id===t)||null}function l(t,e){let n=a(),r=n.findIndex(e=>e.id===t);return -1===r?(console.error("Job not found:",t),null):(n[r]={...n[r],...e,updatedAt:new Date().toISOString()},f(n),n[r])}function u(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=s(t);if(!o)return null;let i={trialId:e,step:o.currentStep+1,result:n,notes:r,timestamp:new Date().toISOString()};return l(t,{attempts:[...o.attempts,i],currentStep:o.currentStep+1})}function d(t,e){let n=s(t);return n?l(t,{currentStep:n.currentStep+1,currentTrialId:e}):null}function p(t){return l(t,{status:"DONE"})}function h(t){return l(t,{status:"CANCELLED"})}function f(t){try{localStorage.setItem(r,JSON.stringify(t))}catch(t){console.error("Error saving jobs to storage:",t)}}function g(t){f(a().filter(e=>e.id!==t))}function x(){let t=a(),e={},n=["SELF_FIXING","NEED_PRO","ASSIGNED","IN_PROGRESS"];t.forEach(t=>{n.includes(t.status)&&(e[t.caseId]||(e[t.caseId]=[]),e[t.caseId].push(t))});let r=!1;return Object.keys(e).forEach(n=>{let o=e[n];o.length>1&&(o.sort((t,e)=>new Date(e.updatedAt)-new Date(t.updatedAt)),o[0],o.slice(1).forEach(e=>{let n=t.findIndex(t=>t.id===e.id);-1!==n&&(t[n].status="CANCELLED",t[n].updatedAt=new Date().toISOString(),r=!0)}))}),r&&f(t),r}}}]);